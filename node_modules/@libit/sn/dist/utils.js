"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.executeSync = exports.execute = exports.digester = exports.DEFAULT_DELIMITER = void 0;
const tslib_1 = require("tslib");
const crypto_1 = tslib_1.__importDefault(require("crypto"));
const execa_1 = tslib_1.__importDefault(require("execa"));
exports.DEFAULT_DELIMITER = /[:\n]/;
function digester(alg) {
    return (data) => crypto_1.default.createHash(alg).update(data).digest('hex');
}
exports.digester = digester;
async function execute(cmd, options) {
    var _a, _b, _c;
    const { stdout } = await execa_1.default.command(cmd.trim(), { shell: true });
    const answer = (_b = stdout === null || stdout === void 0 ? void 0 : stdout.trim().split((_a = options === null || options === void 0 ? void 0 : options.delimiter) !== null && _a !== void 0 ? _a : exports.DEFAULT_DELIMITER).pop()) === null || _b === void 0 ? void 0 : _b.trim();
    return !answer || ((_c = options === null || options === void 0 ? void 0 : options.ignores) === null || _c === void 0 ? void 0 : _c.some(ig => ig.test(answer))) ? undefined : answer;
}
exports.execute = execute;
function executeSync(cmd, options) {
    var _a, _b, _c;
    const { stdout } = execa_1.default.commandSync(cmd.trim(), { shell: true });
    const answer = (_b = stdout === null || stdout === void 0 ? void 0 : stdout.trim().split((_a = options === null || options === void 0 ? void 0 : options.delimiter) !== null && _a !== void 0 ? _a : exports.DEFAULT_DELIMITER).pop()) === null || _b === void 0 ? void 0 : _b.trim();
    return !answer || ((_c = options === null || options === void 0 ? void 0 : options.ignores) === null || _c === void 0 ? void 0 : _c.some(ig => ig.test(answer))) ? undefined : answer;
}
exports.executeSync = executeSync;
//# sourceMappingURL=utils.js.map